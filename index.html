<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Bubbles</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="bubbleCanvas"></canvas>

<script>
const canvas = document.getElementById('bubbleCanvas');
const ctx = canvas.getContext('2d');

let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;

window.addEventListener('resize', () => {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
});

class Bubble {
  constructor(x, y, radius, color, heading, text, isParent=false, image=null) {
    this.x = x;
    this.y = y;
    this.radius = radius;
    this.color = color;
    this.heading = heading;
    this.text = text;
    this.isParent = isParent;
    this.image = image;
    this.subBubbles = [];
    this.vx = (Math.random() - 0.5) * 1;
    this.vy = (Math.random() - 0.5) * 1;
  }

  addSubBubble(bubble) {
    this.subBubbles.push(bubble);
  }

  draw(ctx) {
    // Draw bubble
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
    ctx.fillStyle = this.color;
    ctx.fill();
    ctx.closePath();

    // Draw heading
    ctx.fillStyle = "#000";
    ctx.font = `${this.radius * 0.2}px Arial`;
    ctx.textAlign = "center";
    ctx.fillText(this.heading, this.x, this.y - this.radius * 0.5);

    // Draw text
    ctx.font = `${this.radius * 0.12}px Arial`;
    const textLines = this.text.match(/.{1,15}/g) || [];
    textLines.forEach((line, i) => {
      ctx.fillText(line, this.x, this.y - this.radius * 0.2 + i * this.radius * 0.18);
    });

    // Draw image if exists
    if (this.image) {
      const imgSize = this.radius * 0.6;
      ctx.drawImage(this.image, this.x - imgSize/2, this.y - imgSize/2 + this.radius*0.1, imgSize, imgSize);
    }
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;

    // Bounce off edges
    if (this.x + this.radius > width || this.x - this.radius < 0) this.vx *= -1;
    if (this.y + this.radius > height || this.y - this.radius < 0) this.vy *= -1;

    // Keep sub-bubbles inside parent
    if (this.isParent) {
      this.subBubbles.forEach(sb => {
        const dx = sb.x - this.x;
        const dy = sb.y - this.y;
        const dist = Math.sqrt(dx*dx + dy*dy);
        if (dist + sb.radius > this.radius) {
          const angle = Math.atan2(dy, dx);
          sb.x = this.x + (this.radius - sb.radius) * Math.cos(angle);
          sb.y = this.y + (this.radius - sb.radius) * Math.sin(angle);
        }
        sb.update();
      });
    }
  }
}

// Load image for photo bubble
const photo = new Image();
photo.src = 'https://via.placeholder.com/100'; // replace with your actual image URL

photo.onload = () => {
  init();
};

function init() {
  const bubbles = [];

  const colors = ['#f94144','#f3722c','#f8961e','#f9844a','#f9c74f','#90be6d','#43aa8b','#577590'];

  const researchBubble = new Bubble(
    Math.random() * width,
    Math.random() * height,
    120,
    colors[0],
    'Research',
    'Main research bubble with subtopics',
    true
  );

  // Create sub-bubbles
  const sub1 = new Bubble(researchBubble.x + 30, researchBubble.y, 40, colors[1], 'Sub1', 'Subtopic 1');
  const sub2 = new Bubble(researchBubble.x - 50, researchBubble.y - 20, 40, colors[2], 'Sub2', 'Subtopic 2');
  const sub3 = new Bubble(researchBubble.x + 10, researchBubble.y + 50, 40, colors[3], 'Sub3', 'Subtopic 3');

  researchBubble.addSubBubble(sub1);
  researchBubble.addSubBubble(sub2);
  researchBubble.addSubBubble(sub3);

  // Create photo bubble
  const photoBubble = new Bubble(
    Math.random() * width,
    Math.random() * height,
    80,
    colors[4],
    'Photo',
    '',
    false,
    photo
  );

  const otherBubbles = [
    new Bubble(Math.random()*width, Math.random()*height, 60, colors[5], 'Bubble1', 'Extra bubble 1'),
    new Bubble(Math.random()*width, Math.random()*height, 60, colors[6], 'Bubble2', 'Extra bubble 2'),
    new Bubble(Math.random()*width, Math.random()*height, 60, colors[7], 'Bubble3', 'Extra bubble 3')
  ];

  bubbles.push(researchBubble, photoBubble, ...otherBubbles);

  function animate() {
    ctx.clearRect(0, 0, width, height);
    bubbles.forEach(b => {
      b.update();
      b.draw(ctx);
      if (b.isParent) {
        b.subBubbles.forEach(sb => sb.draw(ctx));
      }
    });
    requestAnimationFrame(animate);
  }

  animate();
}
</script>
</body>
</html>
